README - Susanne going through Kristinas Scripts

Checked so far: 

• hormone_outlier-detection_SD.py:	Detects and visualises outliers in hormonal data based on standard deviation thresholds and predefined reference ranges	Requirements: Hormone_data.csv (hormone measurements per participants), complete_participants.csv (list of included participants)	Output: Boxplots for each hormone and sex (png), excluded_subjects.csv (list of subjects marked as outliers for manual review), filtered dataset excluding confirmed outliers• hormone_analysis.py:	Performs statistical analyses of hormonal levels between sexes, including normality tests (Shapiro-Wilk, Kolmogorov-Smirnov), group comparison (Mann-Whitney U), and inter-hormone correlations (Spearman)	Requirements: Hormone_data.csv, complete_participants.csv, excluded_subjects.csv	Output: hormone_summary_table.csv, (mean, SD, p-values, effect sizes), hormone_statistical_results.csv (all test results), spearman_results_male.csv/ spearman_results_female.csv, Boxplots of hormone distributions (png)

• participants_verification.py:	Verifies participants inclusion across all movie fMRI datasets by checking completeness of timepoints, ROI data, and consistency with hormone/phenotype datasets	Requirements: Dataset_movie_project_completeness.csv, movies_phenotype_results.csv, BOLD movie csv files: BOLD_Schaefer400_subcor36_mean_task-*_MOVIES_INM7.csv	Output: complete_participants.csv (list of valid participants), excluded_participants_log.csv (participants excluded per movie with reasons)






README - brainvar_hormone_movieSex Differences in Brain Activity during Naturalistic Viewing and their Association with Hormonal LevelsThis repository contains scripts used for the analysis of hormonal and fMRI data for my master thesis derived from the Movie study (Dr. Mochalski, 2023; source folder: inm7_movies) For questions or further information, please contact BauerKristina1@web.deScripts:• PCA_foreachsex_allROI_latestversion.py:	Performs PCA separately for male and female participants across all ROIs and multiple movie fMRI datasets. Data are z-standardised, concatenated across movies, filtered by valid participants, and reduced to the first two principal components (PC1, PC2)	Requirements: BOLD movie csv files: BOLD_Schaefer400_subcor36_mean_task-*_MOVIES_INM7.csv, movies_phenotype_results.csv (participant_ID, gender), complete_participants.csv (from participants_verification.py), excluded_subjects.csv (from hormone_outlier_detection_SD.py)	Output: PC1_loadings_[female/male]_allROI.csv, PC2_loadings_[female/male]_allROI.csv, PC1_scores_[female/male]_allROI.csv, PC2_scores_[female/male]_allROI.csv, explained_variance_1_[female/male]_allROI.csv, explained_variance_2_[female/male]_allROI.csv• wrap_run_python_latestversion.sh:	Bash wrapper script to execute PCA_foreachsex_allROI_latestversion.py within the predefined virtual environment	Requirements: hormone_env (virtual environment), PCA_foreachsex_allROI_latestversion.py • submitrun_latestversion.sh:	HTCondor submission script for automated batch execution of PCA analses across all movie fMRI datasets	Requirements: HTCondor environment, wrap_run_python_latestversion.sh, PCA_foreachsex_allROI_latestversion.py, BOLD movie csv files: BOLD_Schaefer400_subcor36_mean_task-*_MOVIES_INM7.csv, movies_phenotype_results.csv, complete_participants.csv, excluded_subjects.csv 	Output: Condor log, output, and error files per jobs in logs_pca/• hormone_env:	Bash script to create and configure the Python virtual environment used for all analyses	Requirements: Python 3	Installed Packages: nibabel, nilearn, pandas, numpy, scipy, scikit-learn, matplotlib, joblib, spyder-kernels==3.0	Output: virtual environment ready for executing all Python script in the project• correlation_brainactivity_hormonallevels.py:	Computes Spearman correlations between PC1 loadings and hormonal levels, separately for male and female participants	Requirements: PC1_loadings_female_allROI.csv, PC1_loadings_male_allROI.csv, Hormone_data.csv, complete_participants.csv (from participants_verification.py), excluded_subjects.csv (from hormone_outlier_detection_SD.py), ROI atlas NifTI: Susanne_Schaefer_436.nii	Output: regionwise_correlation_results.csv (Spearman’s rho and p-values per ROI, hormone, and sex), Glass brain plots (png) per hormone and sex (stored in brain_maps/)• Schaefer_harvard_oxford_overlap.py:	Computes voxel-wise overlap between the Schaefer cortical atlas (400 parcels, 17 networks) and the Harvard_Oxford cortical and subcortical atlases. Outputs a table with overlap statistics for each Schaefer parcel	Requirements: Nilearn datasets (fetches Schaefer 2018 and Harvard-Oxford atlases automatically) 	Output: schaefer_to_anatomical_overlap.csv (containing for each Schaefer parcel: Anatomical region(s) from Harvard-Oxford atlas overlapping with the parcel, number of overlapping voxels, total voxels in the parcels, percent overlap)• demographic.py:	Generates a demographic summary table and analyses female participants’ menstrual cycle data	Requirements: Hormone_data.csv, complete_participants.csv, excluded_subjects.csv	Output: demographics_table.csv (summarising for each sex and overall: number of participants, Age (mean ± SD) and range, highest education level), cycle_day_histogram_females.png • Top5_correlations_female_male_counterpart.py:	Identifies the top 5 brain regions per hormone in females based on significant Spearman correlations and compares these with male participants	Requirements: regionwise_correlation_results.csv, fMRI dataset (for ROI names), BOLD_Schaefer400_subcor36_mean_task-dps_MOVIES_INM7.csv	Output: top5_females_male_comparison.csv (without ROI names),  top5_females_male_comparison_with_roi_names.csv (including ROI names)